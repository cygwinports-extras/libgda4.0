--- origsrc/libgda-4.0.3/configure.in	2009-08-24 12:19:57.000000000 -0500
+++ src/libgda-4.0.3/configure.in	2009-08-25 22:28:11.288477100 -0500
@@ -145,11 +145,13 @@ EXPORT_SYM_REGEX='-export-symbols-regex 
 EXPORT_PROV_SYM_REGEX='-export-symbols-regex "^(plugin_|Java_|g_module).*"'
 AC_MSG_CHECKING([for platform])
 platform_win32=no
+platform_cygwin=no
 platform_carbon=no
 linklibext=".so"
 case "$host" in
 *-cygwin*)
     AC_MSG_RESULT([Win32 - cygwin])
+    platform_cygwin=yes
     NO_UNDEFINED='-no-undefined'
     SOPREFIX='cyg'
     LIBTOOL_EXPORT_OPTIONS=$EXPORT_SYM_REGEX
@@ -194,6 +196,7 @@ case "$host" in
 esac
 
 AM_CONDITIONAL(PLATFORM_WIN32, [test $platform_win32 = yes])
+AM_CONDITIONAL(PLATFORM_CYGWIN, [test $platform_win32 = yes])
 AM_CONDITIONAL(PLATFORM_CARBON, [test $platform_carbon = yes])
 AC_SUBST(LIBTOOL_EXPORT_OPTIONS)
 AC_SUBST(LIBTOOL_PROV_EXPORT_OPTIONS)
@@ -335,6 +338,18 @@ then
 				break
 			fi
 
+			if test $platform_cygwin = yes -a -e $d/include/db.h -a -e $d/lib/libdb.la
+			then
+				eval `$GREP '^dlname=' $d/lib/libdb.la`
+				AC_MSG_RESULT(found Berkeley DB in $d)
+				AC_DEFINE(HAVE_BDB, 1, [Have Berkeley DB])
+				bdbdir=$d
+				BDB_CFLAGS="-I${bdbdir}/include"
+				BDB_LIB="${dlname##*/}"
+				BDB_LIBS="-L${bdbdir}/lib -ldb"
+				break
+			fi
+
 			if test $platform_win32 = no -a -f $d/include/db.h -a -f $d/$lib/libdb$linklibext
 			then
 				AC_MSG_RESULT(found Berkeley DB in $d)
@@ -1098,7 +1113,7 @@ dnl test for system-installed SQLite
 dnl If no SQLite is found or if the SQLite found does not have the sqlite3_table_column_metadata()
 dnl function call, then use the embedded version
 dnl also, on Win32, always use the embedded version
-if test x"$platform_win32" = "xyes"
+if test x"$platform_win32" = "xyes" -o x"$platform_cygwin" = "xyes"
 then
         AM_CONDITIONAL(HAVE_SQLITE, 0)
 else
